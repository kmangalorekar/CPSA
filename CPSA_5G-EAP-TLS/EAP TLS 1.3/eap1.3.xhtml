<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>5G EAP-TLS 1.3 Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;5G EAP-TLS 1.3 Protocol&quot; (algebra diffie-hellman))
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from eap1.3.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t18">18</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.600pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.600 754.920' font-size='12.000'>
  <text
   x='239.640' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='39.960' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol eap diffie-hellman
  (defrole ue
    (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
      (ue nw ca name) (x rndx) (h1 base))
    (trace (send (enc supi nonce_ue (pubk nw))) (recv &quot;Start TLS&quot;)
      (send (cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)))
      (recv
        (cat &quot;Server-Hello&quot; nonce_nw h1
          (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
            nonce_nw h1 (exp h1 x))
          (enc nw &quot;Certificate-Request&quot; nonce_nw2
            (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
              &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
          (enc nw (pubk nw) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1
              (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
              (enc nw (pubk nw) (privk ca))) (privk nw))
          (enc
            (hash (hash (exp h1 x) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw
                h1
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                    &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
                (enc nw (pubk nw) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot;
                    nonce_nw h1
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                      &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                        &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                      (privk ca)) (enc nw (pubk nw) (privk ca)))
                  (privk nw)))) (privk ca))))
      (send
        (cat (enc ue (pubk ue) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1
              (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
              (enc ue (pubk ue) (privk ca))) (privk ue))
          (enc
            (hash (hash (exp h1 x) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw
                h1
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                    &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
                (enc ue (pubk ue) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot;
                    nonce_nw h1
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                      &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                        &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                      (privk ca)) (enc ue (pubk ue) (privk ca)))
                  (privk ue)))) (privk ca)))))
    (non-orig (privk ca))
    (uniq-gen x))
  (defrole nw
    (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
      (ue nw ca name) (y rndx) (h2 base))
    (trace (recv (enc supi nonce_ue (pubk nw))) (send &quot;tls_start&quot;)
      (recv (cat &quot;Client-Hello&quot; nonce_ue2 h2))
      (send
        (cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y)
          (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
            (exp (gen) y) (exp h2 y))
          (enc nw &quot;Certificate-Request&quot; nonce_nw2
            (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
              (exp (gen) y) (exp h2 y)) (privk ca))
          (enc nw (pubk nw) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
              (exp (gen) y)
              (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                nonce_nw (exp (gen) y) (exp h2 y))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
              (enc nw (pubk nw) (privk ca))) (privk nw))
          (enc
            (hash (hash (exp h2 y) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
                (exp (gen) y)
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                (enc nw (pubk nw) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y)
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                      nonce_nw (exp (gen) y) (exp h2 y))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                        nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                    (enc nw (pubk nw) (privk ca))) (privk nw))))
            (privk ca))))
      (recv
        (cat (enc ue (pubk ue) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
              (exp (gen) y)
              (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                nonce_nw (exp (gen) y) (exp h2 y))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
              (enc ue (pubk ue) (privk ca))) (privk ue))
          (enc
            (hash (hash (exp h2 y) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
                (exp (gen) y)
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                (enc ue (pubk ue) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y)
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                      nonce_nw (exp (gen) y) (exp h2 y))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                        nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                    (enc ue (pubk ue) (privk ca))) (privk ue))))
            (privk ca)))))
    (non-orig (privk ca))
    (uniq-gen y)
    (absent (y h2))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k1">1</a> <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 h1) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>eap 0</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (h1 base) (x rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 h1) (x x))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (label 0)
  (unrealized (0 3))
  (origs (nonce_ue (0 0)) (nonce_ue2 (0 2)))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca-0)) (enc nw (pubk nw) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca-0)) (enc nw (pubk nw) (privk ca-0))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca-0)) (enc nw (pubk nw) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca-0)) (enc nw (pubk nw) (privk ca-0))) (privk nw)))) (privk ca-0)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw nw) (ca ca-0) (h2 (exp (gen) x)) (y y))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 1</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_nw2-0
      supi-0 data) (ue nw ca ca-0 name) (x y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw nw)
    (ca ca-0) (h2 (exp (gen) x)) (y y))
  (precedes ((0 2) (1 2)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (added-strand nw 4)
    (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
      nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (0 3))
  (label 1)
  (parent 0)
  (unrealized (0 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k0">0</a>, Children: <a href="#k4">4</a> <a href="#k5">5</a> <a href="#k6">6</a> <a href="#k7">7</a> <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp h1 x)</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(exp h1 x)</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 h1) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 2</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (h1 base) (x rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 h1) (x x))
  (deflistener (exp h1 x))
  (precedes ((0 2) (1 0)) ((1 1) (0 3)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (added-listener (exp h1 x))
    (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
      nonce_nw h1 (exp h1 x)) (0 3))
  (label 2)
  (parent 0)
  (unrealized (0 3) (1 0))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 3</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw supi nonce_ue-0 nonce_nw2 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw)
    (ca ca) (h2 (exp (gen) x)) (y y))
  (precedes ((0 2) (1 2)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (displaced 2 1 nw 4)
    (enc nw &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca-0))
    (0 3))
  (label 3)
  (parent 1)
  (unrealized (0 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(gen)</title><circle cx='139.920' cy='339.960' r='6.000'/>
   </g>
  <g><title>(gen)</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (gen) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (gen) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) (rec x))) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 4</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (x rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) (rec x))) (x x))
  (deflistener (gen))
  (precedes ((0 2) (1 0)) ((1 1) (0 3)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (contracted (h1 (exp (gen) (rec x)))) (gen)
    (1 0))
  (label 4)
  (parent 2)
  (unrealized (0 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) x)</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(exp (gen) x)</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (gen) &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (gen) &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (gen) &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (gen) &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (gen) &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (gen) &quot;Server-Hello&quot; nonce_nw (gen) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (gen) (exp (gen) x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (gen)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 5</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (x rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (gen)) (x x))
  (deflistener (exp (gen) x))
  (precedes ((0 2) (1 0)) ((1 1) (0 3)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (displaced 2 0 ue 3) (exp (gen) x-0) (1 0))
  (label 5)
  (parent 2)
  (unrealized (0 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) x-0)</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(exp (gen) x-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) x-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) x-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (supi supi-0) (nw nw-0) (x x-0))</title>
   <text x='239.880' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) x-0))) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>eap 6</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      supi-0 data) (ue nw ca nw-0 name) (x x-0 rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) x-0))) (x x))
  (deflistener (exp (gen) x-0))
  (defstrand ue 3 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (supi supi-0) (nw nw-0) (x x-0))
  (precedes ((0 2) (1 0)) ((1 1) (0 3)) ((2 2) (1 0)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x x-0)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (added-strand ue 3) (exp (gen) x-0) (1 0))
  (label 6)
  (parent 2)
  (unrealized (0 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)))) (privk ca-0)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-0 h2)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) y)</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) y)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw nw-0) (ca ca-0) (h2 h2) (y y))</title>
   <text x='239.880' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) y))) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>eap 7</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 ca-0 name)
    (h2 base) (x y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) y))) (x x))
  (deflistener (exp (gen) y))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0)
    (nw nw-0) (ca ca-0) (h2 h2) (y y))
  (precedes ((0 2) (1 0)) ((1 1) (0 3)) ((2 3) (1 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (added-strand nw 4) (exp (gen) y) (1 0))
  (label 7)
  (parent 2)
  (unrealized (0 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k9">9</a> <a href="#k10">10</a> <a href="#k11">11</a> <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp h1 (mul x (rec w))) w)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp h1 (mul x (rec w))) w)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp h1 x)</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(exp h1 x)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 h1) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>eap 8</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (h1 base) (x rndx) (w expt))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 h1) (x x))
  (deflistener (exp h1 x))
  (deflistener (cat (exp h1 (mul x (rec w))) w))
  (precedes ((0 2) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (precur (2 0))
  (operation nonce-test
    (added-listener (cat (exp h1 (mul x (rec w))) w)) (exp h1 x) (1 0))
  (label 8)
  (parent 2)
  (unrealized (0 3) (2 0))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) w)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) w)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) w)</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) w)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) w) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) w) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) w))) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>eap 9</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (x rndx) (w expt))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) w))) (x x))
  (deflistener (exp (gen) w))
  (deflistener (cat (gen) w))
  (precedes ((0 2) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (precur (2 0))
  (operation nonce-test (contracted (h1 (exp (gen) (mul (rec x) w))))
    (gen) (2 0))
  (label 9)
  (parent 8)
  (unrealized (0 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) w)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) w)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w x))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w x))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w x)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul w x)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) w)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 10</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (w expt) (x rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) w)) (x x))
  (deflistener (exp (gen) (mul w x)))
  (deflistener (cat (exp (gen) x) w))
  (precedes ((0 2) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (2 0))
  (uniq-gen x)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (displaced 3 0 ue 3) (exp (gen) x-0) (2 0))
  (label 10)
  (parent 8)
  (unrealized (0 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x-0))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) w)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) w)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w x-0))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w x-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul w x-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (supi supi-0) (nw nw-0) (x x-0))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) w x-0))) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 11</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      supi-0 data) (ue nw ca nw-0 name) (x rndx) (w expt) (x-0 rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) w x-0))) (x x))
  (deflistener (exp (gen) (mul w x-0)))
  (deflistener (cat (exp (gen) x-0) w))
  (defstrand ue 3 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (supi supi-0) (nw nw-0) (x x-0))
  (precedes ((0 2) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 2) (2 0)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (2 0))
  (uniq-gen x x-0)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (added-strand ue 3) (exp (gen) x-0) (2 0))
  (label 11)
  (parent 8)
  (unrealized (0 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k8">8</a>, Children: <a href="#k16">16</a> <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)))) (privk ca-0)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-0 h2)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w y))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w y))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul w y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw nw-0) (ca ca-0) (h2 h2) (y y))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) w y))) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 12</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 ca-0 name)
    (h2 base) (x rndx) (w expt) (y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) (mul (rec x) w y))) (x x))
  (deflistener (exp (gen) (mul w y)))
  (deflistener (cat (exp (gen) y) w))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0)
    (nw nw-0) (ca ca-0) (h2 h2) (y y))
  (precedes ((0 2) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 3) (2 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (precur (2 0))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation nonce-test (added-strand nw 4) (exp (gen) y) (2 0))
  (label 12)
  (parent 8)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul x y))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul x y))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 13</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (gen) (mul x y)))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw)
    (ca ca) (h2 (exp (gen) x)) (y y))
  (precedes ((0 2) (3 2)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 3) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (2 0))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (added-strand nw 4)
    (enc nw &quot;Certificate-Request&quot; nonce_nw2
      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (0 3))
  (label 13)
  (parent 9)
  (unrealized (0 3) (1 0) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 14</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (exp (gen) x) y))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw)
    (ca ca) (h2 (exp (gen) x)) (y y))
  (precedes ((0 2) (3 2)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 3) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (2 0))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (added-strand nw 4)
    (enc nw &quot;Certificate-Request&quot; nonce_nw2
      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (0 3))
  (label 14)
  (parent 10)
  (unrealized (0 3) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k11">11</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.260 300.660 244.679 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x-0))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul x (rec x-0) y))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul x (rec x-0) y))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-1) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (supi supi-0) (nw nw-0) (x x-0))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 15</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      supi-0 nonce_ue-1 supi-1 data) (ue nw ca nw-0 name)
    (x x-0 y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (exp (gen) x-0) (mul x (rec x-0) y)))
  (defstrand ue 3 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (supi supi-0) (nw nw-0) (x x-0))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-1) (nw nw)
    (ca ca) (h2 (exp (gen) x)) (y y))
  (precedes ((0 2) (4 2)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 2) (2 0))
    ((4 3) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (2 0))
  (uniq-gen x x-0 y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (added-strand nw 4)
    (enc nw &quot;Certificate-Request&quot; nonce_nw2
      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (0 3))
  (label 15)
  (parent 11)
  (unrealized (0 3) (1 0) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 16</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue supi nonce_ue-0 nonce_ue2 nonce_nw nonce_nw2 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (exp (gen) y) x))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (nw nw)
    (ca ca) (h2 (exp (gen) x)) (y y))
  (precedes ((0 2) (3 2)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 3) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (2 0))
  (uniq-gen x y)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (displaced 4 3 nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0)))
      (privk ca-0)) (0 3))
  (label 16)
  (parent 12)
  (unrealized (0 3) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)))) (privk ca-0)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-0 h2)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x (rec y) y-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x (rec y) y-0))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-1) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw nw-0) (ca ca-0) (h2 h2) (y y))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 17</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 supi-1 data)
    (ue nw ca nw-0 ca-0 name) (h2 base) (x y y-0 rndx))
  (defstrand ue 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (exp (gen) y) (mul x (rec y) y-0)))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0)
    (nw nw-0) (ca ca-0) (h2 h2) (y y))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-1) (nw nw)
    (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((0 2) (4 2)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 3) (2 0))
    ((4 3) (2 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (precur (2 0))
  (uniq-gen x y y-0)
  (uniq-orig nonce_ue nonce_ue2)
  (operation encryption-test (added-strand nw 4)
    (enc nw &quot;Certificate-Request&quot; nonce_nw2
      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (0 3))
  (label 17)
  (parent 12)
  (unrealized (0 3) (1 0) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t18">Tree <a href="#top">18</a>.</p>

<div>
 <svg
  class='diagram' width='329.520pt' height='1504.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 329.520 1504.920' font-size='12.000'>
  <text
   x='189.720' y='1451.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='139.800' y1='1464.960' x2='189.720' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='1451.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='89.880' y1='1464.960' x2='139.800' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='39.960' y1='752.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='39.960' y1='752.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='239.640' y1='1239.960' x2='289.560' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='239.640' y1='1239.960' x2='289.560' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='239.640' y1='1239.960' x2='289.560' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='189.720' y1='939.960' x2='239.640' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='239.640' y1='1052.460' x2='289.560' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='239.640' y1='1052.460' x2='289.560' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1038.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='189.720' y1='939.960' x2='239.640' y2='1052.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='239.640' y1='902.460' x2='289.560' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='239.640' y1='902.460' x2='289.560' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='888.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='189.720' y1='939.960' x2='239.640' y2='902.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='239.640' y1='752.460' x2='289.560' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='239.640' y1='752.460' x2='289.560' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='189.720' y1='939.960' x2='239.640' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='239.640' y1='602.460' x2='289.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='239.640' y1='602.460' x2='289.560' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='189.720' y1='939.960' x2='239.640' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='139.800' y1='752.460' x2='189.720' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='139.800' y1='752.460' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='139.800' y1='752.460' x2='189.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='139.800' y1='752.460' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='139.800' y1='752.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='139.800' y1='752.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='89.880' y1='677.460' x2='139.800' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='89.880' y1='677.460' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='139.800' y1='39.960' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='89.880' y1='677.460' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='39.960' y1='752.460' x2='89.880' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='738.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  </svg></div>

<pre>(defprotocol eap diffie-hellman
  (defrole ue
    (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
      (ue nw ca name) (x rndx) (h1 base))
    (trace (send (enc supi nonce_ue (pubk nw))) (recv &quot;Start TLS&quot;)
      (send (cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)))
      (recv
        (cat &quot;Server-Hello&quot; nonce_nw h1
          (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
            nonce_nw h1 (exp h1 x))
          (enc nw &quot;Certificate-Request&quot; nonce_nw2
            (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
              &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
          (enc nw (pubk nw) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1
              (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
              (enc nw (pubk nw) (privk ca))) (privk nw))
          (enc
            (hash (hash (exp h1 x) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw
                h1
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                    &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
                (enc nw (pubk nw) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot;
                    nonce_nw h1
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                      &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                        &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                      (privk ca)) (enc nw (pubk nw) (privk ca)))
                  (privk nw)))) (privk ca))))
      (send
        (cat (enc ue (pubk ue) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw h1
              (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
              (enc ue (pubk ue) (privk ca))) (privk ue))
          (enc
            (hash (hash (exp h1 x) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot; nonce_nw
                h1
                (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                  &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                    &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x)) (privk ca))
                (enc ue (pubk ue) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h1 &quot;Server-Hello&quot;
                    nonce_nw h1
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                      &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x)
                        &quot;Server-Hello&quot; nonce_nw h1 (exp h1 x))
                      (privk ca)) (enc ue (pubk ue) (privk ca)))
                  (privk ue)))) (privk ca)))))
    (non-orig (privk ca))
    (uniq-gen x))
  (defrole nw
    (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
      (ue nw ca name) (y rndx) (h2 base))
    (trace (recv (enc supi nonce_ue (pubk nw))) (send &quot;tls_start&quot;)
      (recv (cat &quot;Client-Hello&quot; nonce_ue2 h2))
      (send
        (cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y)
          (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
            (exp (gen) y) (exp h2 y))
          (enc nw &quot;Certificate-Request&quot; nonce_nw2
            (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
              (exp (gen) y) (exp h2 y)) (privk ca))
          (enc nw (pubk nw) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
              (exp (gen) y)
              (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                nonce_nw (exp (gen) y) (exp h2 y))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
              (enc nw (pubk nw) (privk ca))) (privk nw))
          (enc
            (hash (hash (exp h2 y) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
                (exp (gen) y)
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                (enc nw (pubk nw) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y)
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                      nonce_nw (exp (gen) y) (exp h2 y))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                        nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                    (enc nw (pubk nw) (privk ca))) (privk nw))))
            (privk ca))))
      (recv
        (cat (enc ue (pubk ue) (privk ca))
          (enc
            (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
              (exp (gen) y)
              (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                nonce_nw (exp (gen) y) (exp h2 y))
              (enc nw &quot;Certificate-Request&quot; nonce_nw2
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
              (enc ue (pubk ue) (privk ca))) (privk ue))
          (enc
            (hash (hash (exp h2 y) &quot;Finished&quot;)
              (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
                (exp (gen) y)
                (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                  nonce_nw (exp (gen) y) (exp h2 y))
                (enc nw &quot;Certificate-Request&quot; nonce_nw2
                  (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                (enc ue (pubk ue) (privk ca))
                (enc
                  (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                    nonce_nw (exp (gen) y)
                    (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                      nonce_nw (exp (gen) y) (exp h2 y))
                    (enc nw &quot;Certificate-Request&quot; nonce_nw2
                      (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot;
                        nonce_nw (exp (gen) y) (exp h2 y)) (privk ca))
                    (enc ue (pubk ue) (privk ca))) (privk ue))))
            (privk ca)))))
    (non-orig (privk ca))
    (uniq-gen y)
    (absent (y h2))))</pre>

<p id="k18">Item <a href="#t18">18</a>, Children: <a href="#k19">19</a> <a href="#k20">20</a> <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>eap 18</text>
  </svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data)
    (ue nw ca name) (h2 base) (y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y)
  (uniq-orig nonce_nw nonce_nw2)
  (label 18)
  (unrealized (0 4))
  (origs (nonce_nw (0 3)) (nonce_nw2 (0 3)))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t18">19</a>, Parent: <a href="#k18">18</a>, Children: <a href="#k22">22</a> <a href="#k23">23</a> <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 h1) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 19</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name)
    (h2 h1 base) (y x rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 h1) (x x))
  (precedes ((1 4) (0 4)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand ue 5)
    (enc ue (pubk ue) (privk ca)) (0 4))
  (label 19)
  (parent 18)
  (unrealized (0 4) (1 3))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t18">20</a>, Parent: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue nw) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>eap 20 (realized)</text></svg></div>

<pre>(defskeleton eap
  (vars (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi data) (nw ca name)
    (h2 base) (y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue nw)
    (nw nw) (ca ca) (h2 h2) (y y))
  (absent (y h2))
  (non-orig (privk nw) (privk ca))
  (uniq-gen y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 1 0 nw 4)
    (enc ue (pubk ue) (privk ca)) (0 4))
  (label 20)
  (parent 18)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw)
        (nonce_nw2 nonce_nw2) (supi supi) (ue nw) (nw nw) (ca ca) (y y)
        (h2 h2))))
  (origs (nonce_nw (0 3)) (nonce_nw2 (0 3))))</pre>

<p id="k21">Item <a href="#t18">21</a>, Parent: <a href="#k18">18</a>, Child: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2-0 y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-0 h2-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk ue))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw ue) (ca ca) (h2 h2-0) (y y-0))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 21</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca name) (h2 h2-0 base)
    (y y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw ue)
    (ca ca) (h2 h2-0) (y y-0))
  (precedes ((1 3) (0 4)))
  (absent (y-0 h2-0) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc ue (pubk ue) (privk ca)) (0 4))
  (label 21)
  (parent 18)
  (unrealized (0 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k22">Item <a href="#t18">22</a>, Parent: <a href="#k19">19</a>, Child: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 22</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_nw2-0
      supi-0 data) (ue nw ca name) (x y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (precedes ((0 3) (1 3)) ((1 2) (0 2)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 2 0 nw 4)
    (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
      nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (1 3))
  (label 22)
  (parent 19)
  (unrealized (0 4) (1 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k23">Item <a href="#t18">23</a>, Parent: <a href="#k19">19</a>, Child: <a href="#k27">27</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)))) (privk ca-0)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-1) (supi supi-1) (nw nw-0) (ca ca-0) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='239.880' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 23</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_nw2-1 supi-1 data)
    (ue nw ca nw-0 ca-0 name) (h2 base) (y x y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-1) (supi supi-1)
    (nw nw-0) (ca ca-0) (h2 (exp (gen) x)) (y y-0))
  (precedes ((1 2) (2 2)) ((1 4) (0 4)) ((2 3) (1 3)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
      nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (1 3))
  (label 23)
  (parent 19)
  (unrealized (0 4) (1 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t18">24</a>, Parent: <a href="#k19">19</a>, Children: <a href="#k28">28</a> <a href="#k29">29</a> <a href="#k30">30</a> <a href="#k31">31</a> <a href="#k32">32</a> <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp h1 x)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(exp h1 x)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 h1) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 24</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name)
    (h2 h1 base) (y x rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 h1) (x x))
  (deflistener (exp h1 x))
  (precedes ((1 2) (2 0)) ((1 4) (0 4)) ((2 1) (1 3)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-listener (exp h1 x))
    (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
      nonce_nw-0 h1 (exp h1 x)) (1 3))
  (label 24)
  (parent 19)
  (unrealized (0 4) (1 3) (2 0))
  (comment &quot;6 in cohort - 6 not yet seen&quot;))</pre>

<p id="k25">Item <a href="#t18">25</a>, Parent: <a href="#k21">21</a>, Seen Child: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2-0 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (enc ue &quot;Certificate-Request&quot; nonce_nw2-0 (enc ue &quot;Client-Hello&quot; nonce_ue2-0 h2-0 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2-0 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-0 h2-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk ue))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (enc ue &quot;Certificate-Request&quot; nonce_nw2 (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp h2 y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk ue))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw ue) (ca ca) (h2 h2-0) (y y))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw ue) (ca ca) (h2 h2) (y y-0))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>eap 25 (realized)</text></svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue ca name) (h2 h2-0 base)
    (y y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw ue) (ca ca) (h2 h2) (y y-0))
  (defstrand nw 4 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (nw ue)
    (ca ca) (h2 h2-0) (y y))
  (precedes ((1 3) (0 4)))
  (absent (y-0 h2) (y h2-0))
  (non-orig (privk ue) (privk ca))
  (uniq-gen y y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 2 0 nw 4)
    (enc
      (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
        (exp (gen) y-0)
        (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
          (exp (gen) y-0) (exp h2 y-0))
        (enc ue &quot;Certificate-Request&quot; nonce_nw2
          (enc ue &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw
            (exp (gen) y-0) (exp h2 y-0)) (privk ca))
        (enc ue (pubk ue) (privk ca))) (privk ue)) (0 4))
  (label 25)
  (parent 21)
  (seen 20)
  (unrealized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k26">Item <a href="#t18">26</a>, Parent: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>eap 26</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (precedes ((0 3) (1 3)) ((1 2) (0 2)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 2 0 nw 4)
    (enc nw &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (1 3))
  (label 26)
  (parent 22)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k27">Item <a href="#t18">27</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='239.880' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 27</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 supi-0 nonce_ue-1 nonce_nw2-0 supi-1 data)
    (ue nw nw-0 ca name) (h2 base) (y x y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((1 2) (2 2)) ((1 4) (0 4)) ((2 3) (1 3)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 3 2 nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-1
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0)))
      (privk ca-0)) (1 3))
  (label 27)
  (parent 23)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k28">Item <a href="#t18">28</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(gen)</title><circle cx='239.880' cy='339.960' r='6.000'/>
   </g>
  <g><title>(gen)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (gen) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (gen) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (rec x)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (rec x)) (gen)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (rec x))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 28</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name) (h2 base)
    (y x rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (rec x))) (x x))
  (deflistener (gen))
  (precedes ((1 2) (2 0)) ((1 4) (0 4)) ((2 1) (1 3)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (contracted (h1 (exp (gen) (rec x)))) (gen)
    (2 0))
  (label 28)
  (parent 24)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k29">Item <a href="#t18">29</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) x)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(exp (gen) x)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (gen) &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (gen) &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (gen) &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (gen) &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (gen) &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (gen) &quot;Server-Hello&quot; nonce_nw-0 (gen) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (gen) (exp (gen) x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (gen)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 29</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name) (h2 base)
    (y x rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (gen)) (x x))
  (deflistener (exp (gen) x))
  (precedes ((1 2) (2 0)) ((1 4) (0 4)) ((2 1) (1 3)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (displaced 3 1 ue 3) (exp (gen) x-0) (2 0))
  (label 29)
  (parent 24)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k30">Item <a href="#t18">30</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-1 (exp (gen) x-0))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-1))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) x-0)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(exp (gen) x-0)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) x-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) x-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) x-0)) (exp (gen) x-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1) (supi supi-1) (nw nw-1) (x x-0))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) x-0))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 30</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_ue2-1 supi-1 data)
    (ue nw ca nw-0 nw-1 name) (h2 base) (y x x-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) x-0))) (x x))
  (deflistener (exp (gen) x-0))
  (defstrand ue 3 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1)
    (supi supi-1) (nw nw-1) (x x-0))
  (precedes ((1 2) (2 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 2) (2 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (added-strand ue 3) (exp (gen) x-0) (2 0))
  (label 30)
  (parent 24)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k31">Item <a href="#t18">31</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) y)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) y)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y)) (exp (gen) y)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 186.900 339.960 233.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) y))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>eap 31</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name) (h2 base)
    (x y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) y))) (x x))
  (deflistener (exp (gen) y))
  (precedes ((0 3) (2 0)) ((1 2) (2 0)) ((1 4) (0 4)) ((2 1) (1 3)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (displaced 3 0 nw 4) (exp (gen) y-0) (2 0))
  (label 31)
  (parent 24)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k32">Item <a href="#t18">32</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0))) (privk nw-1)) (enc (hash (hash (exp h2-0 y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0))) (privk nw-1)))) (privk ca-0)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-1 h2-0)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) y-0)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) y-0)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) y-0)) (exp (gen) y-0)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 186.900 339.960 233.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1) (nonce_nw nonce_nw-1) (nonce_nw2 nonce_nw2-1) (supi supi-1) (nw nw-1) (ca ca-0) (h2 h2-0) (y y-0))</title>
   <text x='339.840' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) y-0))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 32</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_ue2-1 nonce_nw-1
      nonce_nw2-1 supi-1 data) (ue nw ca nw-0 nw-1 ca-0 name)
    (h2 h2-0 base) (y x y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) y-0))) (x x))
  (deflistener (exp (gen) y-0))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1)
    (nonce_nw nonce_nw-1) (nonce_nw2 nonce_nw2-1) (supi supi-1)
    (nw nw-1) (ca ca-0) (h2 h2-0) (y y-0))
  (precedes ((1 2) (2 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 3) (2 0)))
  (absent (y-0 h2-0) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (added-strand nw 4) (exp (gen) y-0) (2 0))
  (label 32)
  (parent 24)
  (unrealized (0 4) (1 3))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k33">Item <a href="#t18">33</a>, Parent: <a href="#k24">24</a>, Children: <a href="#k34">34</a> <a href="#k35">35</a> <a href="#k36">36</a> <a href="#k37">37</a> <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp h1 (mul x (rec w))) w)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp h1 (mul x (rec w))) w)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp h1 x)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(exp h1 x)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp h1 x) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h1 &quot;Server-Hello&quot; nonce_nw-0 h1 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 h1 (exp h1 x)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 h1) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 33</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name)
    (h2 h1 base) (y x rndx) (w expt))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 h1) (x x))
  (deflistener (exp h1 x))
  (deflistener (cat (exp h1 (mul x (rec w))) w))
  (precedes ((1 2) (3 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (precur (3 0))
  (operation nonce-test
    (added-listener (cat (exp h1 (mul x (rec w))) w)) (exp h1 x) (2 0))
  (label 33)
  (parent 24)
  (unrealized (0 4) (1 3) (3 0))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k34">Item <a href="#t18">34</a>, Parent: <a href="#k33">33</a>, Children: <a href="#k39">39</a> <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) w)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) w)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) w)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) w)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) w) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) w) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w)) (exp (gen) w)) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 34</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name) (h2 base)
    (y x rndx) (w expt))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w))) (x x))
  (deflistener (exp (gen) w))
  (deflistener (cat (gen) w))
  (precedes ((1 2) (3 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (precur (3 0))
  (operation nonce-test (contracted (h1 (exp (gen) (mul (rec x) w))))
    (gen) (3 0))
  (label 34)
  (parent 33)
  (unrealized (0 4) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k35">Item <a href="#t18">35</a>, Parent: <a href="#k33">33</a>, Children: <a href="#k41">41</a> <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) w)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) w)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w x))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w x))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w x)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul w x)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) w) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) w) (exp (gen) (mul w x))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) w)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 35</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name) (h2 base)
    (y rndx) (w expt) (x rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) w)) (x x))
  (deflistener (exp (gen) (mul w x)))
  (deflistener (cat (exp (gen) x) w))
  (precedes ((1 2) (3 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen y x)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (displaced 4 1 ue 3) (exp (gen) x-0) (3 0))
  (label 35)
  (parent 33)
  (unrealized (0 4) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k36">Item <a href="#t18">36</a>, Parent: <a href="#k33">33</a>, Children: <a href="#k43">43</a> <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-1 (exp (gen) x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-1))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) w)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) w)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w x-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w x-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul w x-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w x-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w x-0)) (exp (gen) (mul w x-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1) (supi supi-1) (nw nw-1) (x x-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w x-0))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 36</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_ue2-1 supi-1 data)
    (ue nw ca nw-0 nw-1 name) (h2 base) (y x rndx) (w expt) (x-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w x-0))) (x x))
  (deflistener (exp (gen) (mul w x-0)))
  (deflistener (cat (exp (gen) x-0) w))
  (defstrand ue 3 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1)
    (supi supi-1) (nw nw-1) (x x-0))
  (precedes ((1 2) (3 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 2) (3 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen y x x-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (added-strand ue 3) (exp (gen) x-0) (3 0))
  (label 36)
  (parent 33)
  (unrealized (0 4) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k37">Item <a href="#t18">37</a>, Parent: <a href="#k33">33</a>, Children: <a href="#k45">45</a> <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w y))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w y))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul w y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y)) (exp (gen) (mul w y))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 236.880 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w y))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 37</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 data) (ue nw ca nw-0 name) (h2 base)
    (x rndx) (w expt) (y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w y))) (x x))
  (deflistener (exp (gen) (mul w y)))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 3) (3 0)) ((1 2) (3 0)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)))
  (absent (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (displaced 4 0 nw 4) (exp (gen) y-0) (3 0))
  (label 37)
  (parent 33)
  (unrealized (0 4) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k38">Item <a href="#t18">38</a>, Parent: <a href="#k33">33</a>, Children: <a href="#k47">47</a> <a href="#k48">48</a> <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0))) (privk nw-1)) (enc (hash (hash (exp h2-0 y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0))) (privk nw-1)))) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-1 h2-0)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul w y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul w y-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul w y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul w y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) (mul (rec x) w y-0)) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) (mul (rec x) w y-0)) (exp (gen) (mul w y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 236.880 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1) (nonce_nw nonce_nw-1) (nonce_nw2 nonce_nw2-1) (supi supi-1) (nw nw-1) (ca ca-0) (h2 h2-0) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w y-0))) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 38</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_ue2-1 nonce_nw-1
      nonce_nw2-1 supi-1 data) (ue nw ca nw-0 nw-1 ca-0 name)
    (h2 h2-0 base) (y x rndx) (w expt) (y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) (mul (rec x) w y-0))) (x x))
  (deflistener (exp (gen) (mul w y-0)))
  (deflistener (cat (exp (gen) y-0) w))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1)
    (nonce_nw nonce_nw-1) (nonce_nw2 nonce_nw2-1) (supi supi-1)
    (nw nw-1) (ca ca-0) (h2 h2-0) (y y-0))
  (precedes ((1 2) (3 0)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 3) (3 0)))
  (absent (y-0 h2-0) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (precur (3 0))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation nonce-test (added-strand nw 4) (exp (gen) y-0) (3 0))
  (label 38)
  (parent 33)
  (unrealized (0 4) (1 3))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t18">39</a>, Parent: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul x y))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul x y))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 39</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (gen) (mul x y)))
  (precedes ((0 3) (3 0)) ((1 2) (0 2)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 4 0 nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 39)
  (parent 34)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k40">Item <a href="#t18">40</a>, Parent: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul x y-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul x y-0))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 40</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 supi-1 data)
    (ue nw ca nw-0 name) (h2 base) (y x y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (gen) (mul x y-0)))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((1 2) (4 2)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 3) (3 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 40)
  (parent 34)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k41">Item <a href="#t18">41</a>, Parent: <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 41</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 3) (3 0)) ((1 2) (0 2)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 4 0 nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 41)
  (parent 35)
  (unrealized (0 4) (1 3) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k42">Item <a href="#t18">42</a>, Parent: <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y-0)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y-0)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 42</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 supi-1 data)
    (ue nw ca nw-0 name) (h2 base) (y x y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (exp (gen) x) y-0))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((1 2) (4 2)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 3) (3 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 42)
  (parent 35)
  (unrealized (0 4) (1 3) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k43">Item <a href="#t18">43</a>, Parent: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.220 300.660 344.639 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul x (rec x-0) y))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul x (rec x-0) y))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (supi supi-1) (nw nw-0) (x x-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 43</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0
      nonce_ue-1 nonce_ue2-0 supi-1 data) (ue nw ca nw-0 name)
    (x x-0 y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (exp (gen) x-0) (mul x (rec x-0) y)))
  (defstrand ue 3 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (supi supi-1) (nw nw-0) (x x-0))
  (precedes ((0 3) (3 0)) ((1 2) (0 2)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)) ((4 2) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen x x-0 y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 5 0 nw 4)
    (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 43)
  (parent 36)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k44">Item <a href="#t18">44</a>, Parent: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 442.800 302.460 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-2 nonce_ue-2 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.220 300.660 344.639 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-1 (exp (gen) x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-1))</title>
   <circle cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul x (rec x-0) y-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul x (rec x-0) y-0))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-2) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-2) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='539.760' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1) (supi supi-1) (nw nw-1) (x x-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>eap 44</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_ue2-1 supi-1
      nonce_ue-2 supi-2 data) (ue nw ca nw-0 nw-1 name) (h2 base)
    (y x x-0 y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (exp (gen) x-0) (mul x (rec x-0) y-0)))
  (defstrand ue 3 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1)
    (supi supi-1) (nw nw-1) (x x-0))
  (defstrand nw 4 (nonce_ue nonce_ue-2) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-2)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((1 2) (5 2)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 2) (3 0)) ((5 3) (3 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen y x x-0 y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 44)
  (parent 36)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k45">Item <a href="#t18">45</a>, Parent: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp (gen) (mul x y))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>eap 45</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0 data)
    (ue nw ca name) (x y rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y)) (x x))
  (deflistener (exp (gen) (mul x y)))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 3) (3 0)) ((1 2) (0 2)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen x y)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 4 0 nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 45)
  (parent 37)
  (unrealized (0 4) (1 3) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k46">Item <a href="#t18">46</a>, Parent: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x (rec y) y-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x (rec y) y-0))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 46</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 supi-1 data)
    (ue nw ca nw-0 name) (h2 base) (x y y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (exp (gen) y) (mul x (rec y) y-0)))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((0 3) (3 0)) ((1 2) (4 2)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)) ((4 3) (3 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen x y y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca))
    (1 3))
  (label 46)
  (parent 37)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k47">Item <a href="#t18">47</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 h2 &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y) (exp h2 y)) (privk ca-0)) (enc nw-0 (pubk nw-0) (privk ca-0))) (privk nw-0)))) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-0 h2)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x (rec y) y-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x (rec y) y-0))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1) (nw nw-0) (ca ca-0) (h2 h2) (y y))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue) (nw nw) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 47</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0
      nonce_ue-1 nonce_ue2-0 nonce_nw-0 nonce_nw2-0 supi-1 data)
    (ue nw ca nw-0 ca-0 name) (h2 base) (x y y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi-0) (ue ue)
    (nw nw) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (exp (gen) y) (mul x (rec y) y-0)))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1)
    (nw nw-0) (ca ca-0) (h2 h2) (y y))
  (precedes ((0 3) (3 0)) ((1 2) (0 2)) ((1 4) (0 4)) ((2 1) (1 3))
    ((3 1) (2 0)) ((4 3) (3 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (precur (3 0))
  (uniq-gen x y y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 5 0 nw 4)
    (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1
      (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-1 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca))
    (1 3))
  (label 47)
  (parent 38)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k48">Item <a href="#t18">48</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-0)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-0) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-0) (exp (gen) (mul x y-0))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>eap 48</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 supi-0
      nonce_ue-1 nonce_ue2-0 nonce_nw-0 nonce_nw2-0 supi-1 data)
    (ue nw nw-0 ca name) (h2 base) (y x y-0 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-0)) (x x))
  (deflistener (exp (gen) (mul x y-0)))
  (deflistener (cat (exp (gen) y-0) x))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-1)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-0))
  (precedes ((1 2) (4 2)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 3) (3 0)))
  (absent (y-0 (exp (gen) x)) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca))
  (precur (3 0))
  (uniq-gen y x y-0)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (displaced 5 4 nw 4)
    (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1
      (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-1 (exp (gen) y-1) (exp (gen) (mul x y-1)))
      (privk ca-0)) (1 3))
  (label 48)
  (parent 38)
  (unrealized (0 4) (1 3) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k49">Item <a href="#t18">49</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 442.800 302.460 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-1)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-2 nonce_ue-2 (pubk nw-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0))) (privk nw-1)) (enc (hash (hash (exp h2-0 y-0) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (enc nw-1 &quot;Certificate-Request&quot; nonce_nw2-1 (enc nw-1 &quot;Client-Hello&quot; nonce_ue2-1 h2-0 &quot;Server-Hello&quot; nonce_nw-1 (exp (gen) y-0) (exp h2-0 y-0)) (privk ca-0)) (enc nw-1 (pubk nw-1) (privk ca-0))) (privk nw-1)))) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2-1 h2-0)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-1 nonce_ue-1 (pubk nw-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x (rec y-0) y-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x (rec y-0) y-1))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) (mul x y-1))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(exp (gen) (mul x y-1))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-1) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp (gen) (mul x y-1)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-1) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-1) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-1) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)) (enc (hash (hash (exp (gen) (mul x y-1)) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-1) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) y-1) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0 (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot; nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca)) (enc nw-0 (pubk nw-0) (privk ca))) (privk nw-0)))) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>&quot;Start TLS&quot;</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc supi-0 nonce_ue-0 (pubk nw-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc ue (pubk ue) (privk ca))) (privk ue)))) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)) (enc (hash (hash (exp h2 y) &quot;Finished&quot;) (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca)) (enc (hash &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (enc nw &quot;Certificate-Request&quot; nonce_nw2 (enc nw &quot;Client-Hello&quot; nonce_ue2 h2 &quot;Server-Hello&quot; nonce_nw (exp (gen) y) (exp h2 y)) (privk ca)) (enc nw (pubk nw) (privk ca))) (privk nw)))) (privk ca)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(cat &quot;Client-Hello&quot; nonce_ue2 h2)</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>&quot;tls_start&quot;</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc supi nonce_ue (pubk nw))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((nonce_ue nonce_ue-2) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-2) (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-1))</title>
   <text x='539.760' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1) (nonce_nw nonce_nw-1) (nonce_nw2 nonce_nw2-1) (supi supi-1) (nw nw-1) (ca ca-0) (h2 h2-0) (y y-0))</title>
   <text x='439.800' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0) (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue) (nw nw-0) (ca ca) (h1 (exp (gen) y-1)) (x x))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>ue</text>
   </g>
  <g>
   <title>((nonce_ue nonce_ue) (nonce_ue2 nonce_ue2) (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue) (nw nw) (ca ca) (h2 h2) (y y))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>nw</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>eap 49</text>
  </svg></div>

<pre>(defskeleton eap
  (vars
    (nonce_ue nonce_ue2 nonce_nw nonce_nw2 supi nonce_ue-0 nonce_ue2-0
      nonce_nw-0 nonce_nw2-0 supi-0 nonce_ue-1 nonce_ue2-1 nonce_nw-1
      nonce_nw2-1 supi-1 nonce_ue-2 supi-2 data)
    (ue nw ca nw-0 nw-1 ca-0 name) (h2 h2-0 base) (y x y-0 y-1 rndx))
  (defstrand nw 5 (nonce_ue nonce_ue) (nonce_ue2 nonce_ue2)
    (nonce_nw nonce_nw) (nonce_nw2 nonce_nw2) (supi supi) (ue ue)
    (nw nw) (ca ca) (h2 h2) (y y))
  (defstrand ue 5 (nonce_ue nonce_ue-0) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-0) (ue ue)
    (nw nw-0) (ca ca) (h1 (exp (gen) y-1)) (x x))
  (deflistener (exp (gen) (mul x y-1)))
  (deflistener (cat (exp (gen) y-0) (mul x (rec y-0) y-1)))
  (defstrand nw 4 (nonce_ue nonce_ue-1) (nonce_ue2 nonce_ue2-1)
    (nonce_nw nonce_nw-1) (nonce_nw2 nonce_nw2-1) (supi supi-1)
    (nw nw-1) (ca ca-0) (h2 h2-0) (y y-0))
  (defstrand nw 4 (nonce_ue nonce_ue-2) (nonce_ue2 nonce_ue2-0)
    (nonce_nw nonce_nw-0) (nonce_nw2 nonce_nw2-0) (supi supi-2)
    (nw nw-0) (ca ca) (h2 (exp (gen) x)) (y y-1))
  (precedes ((1 2) (5 2)) ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0))
    ((4 3) (3 0)) ((5 3) (3 0)))
  (absent (y-1 (exp (gen) x)) (y-0 h2-0) (y h2))
  (non-orig (privk ue) (privk nw) (privk ca) (privk ca-0))
  (precur (3 0))
  (uniq-gen y x y-0 y-1)
  (uniq-orig nonce_nw nonce_nw2)
  (operation encryption-test (added-strand nw 4)
    (enc nw-0 &quot;Certificate-Request&quot; nonce_nw2-0
      (enc nw-0 &quot;Client-Hello&quot; nonce_ue2-0 (exp (gen) x) &quot;Server-Hello&quot;
        nonce_nw-0 (exp (gen) y-1) (exp (gen) (mul x y-1))) (privk ca))
    (1 3))
  (label 49)
  (parent 38)
  (unrealized (0 4) (1 3) (2 0) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
