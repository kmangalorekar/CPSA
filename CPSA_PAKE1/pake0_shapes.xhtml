<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Pake</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Pake&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from pake0.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t2">2</a> <a href="#t4">4</a> <a href="#t18">18</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol Pake basic
  (defrole fourth
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (send (enc Nf f (pubk t))) (recv (enc Nf Nt t (pubk f)))
      (send (enc Nt (pubk t)))
      (send (enc (enc pk (hash Nf Nt)) (pubk t))))
    (uniq-orig pk))
  (defrole third
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (recv (enc Nf f (pubk t))) (send (enc Nf Nt t (pubk f)))
      (recv (enc Nt (pubk t)))
      (recv (enc (enc pk (hash Nf Nt)) (pubk t))) (init pk)))
  (defrole alice
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (send Na) (recv Nb)
      (send (hash (hash pk a b Na Nb)))
      (recv (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb)))))
  (defrole bob
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (recv Na) (send Nb)
      (recv (hash (hash pk a b Na Nb)))
      (send (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(hash (hash pk a b Na Nb))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>Nb</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>Na</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>pk</title>
   <circle style='fill: orange;' cx='39.960' cy='114.960' r='6.000'/>
   </g>
  <g><title>((Na Na) (Nb Nb) (a a) (b b) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>alice</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>Pake 0</text>
  </svg></div>

<pre>(defskeleton Pake
  (vars (Na Nb data) (a b name) (pk skey))
  (defstrand alice 5 (Na Na) (Nb Nb) (a a) (b b) (pk pk))
  (uniq-orig Na)
  (label 0)
  (unrealized (0 0))
  (origs (Na (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='414.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(hash (hash pk a b Na Nb))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>Nb</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>Na</title><circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>third</text></g>
  <g><title>((Na Na) (Nb Nb) (a a) (b b) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>alice</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>Pake 1 (realized)</text></svg></div>

<pre>(defskeleton Pake
  (vars (Na Nb Nt Nf data) (a b t f name) (pk skey))
  (defstrand alice 5 (Na Na) (Nb Nb) (a a) (b b) (pk pk))
  (defstrand third 5 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (precedes ((1 4) (0 0)))
  (leadsto ((1 4) (0 0)))
  (uniq-orig Na)
  (operation state-passing-test (added-strand third 5) pk (0 0))
  (label 1)
  (parent 0)
  (unrealized)
  (shape)
  (maps ((0) ((a a) (b b) (Na Na) (Nb Nb) (pk pk))))
  (origs (Na (0 1))))</pre>

<p id="t2">Tree <a href="#top">2</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  </svg></div>

<pre>(defprotocol Pake basic
  (defrole fourth
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (send (enc Nf f (pubk t))) (recv (enc Nf Nt t (pubk f)))
      (send (enc Nt (pubk t)))
      (send (enc (enc pk (hash Nf Nt)) (pubk t))))
    (uniq-orig pk))
  (defrole third
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (recv (enc Nf f (pubk t))) (send (enc Nf Nt t (pubk f)))
      (recv (enc Nt (pubk t)))
      (recv (enc (enc pk (hash Nf Nt)) (pubk t))) (init pk)))
  (defrole alice
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (send Na) (recv Nb)
      (send (hash (hash pk a b Na Nb)))
      (recv (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb)))))
  (defrole bob
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (recv Na) (send Nb)
      (recv (hash (hash pk a b Na Nb)))
      (send (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))))))</pre>

<p id="k2">Item <a href="#t2">2</a>, Child: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(hash (hash pk a b Na Nb))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>Nb</title><circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>Na</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>pk</title>
   <circle style='fill: orange;' cx='39.960' cy='114.960' r='6.000'/>
   </g>
  <g><title>((Na Na) (Nb Nb) (a a) (b b) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>Pake 2</text>
  </svg></div>

<pre>(defskeleton Pake
  (vars (Na Nb data) (a b name) (pk skey))
  (defstrand bob 5 (Na Na) (Nb Nb) (a a) (b b) (pk pk))
  (uniq-orig Nb)
  (label 2)
  (unrealized (0 0))
  (origs (Nb (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t2">3</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='414.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(hash (hash pk a b Na Nb))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>Nb</title><circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>Na</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>third</text></g>
  <g><title>((Na Na) (Nb Nb) (a a) (b b) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>Pake 3 (realized)</text></svg></div>

<pre>(defskeleton Pake
  (vars (Na Nb Nt Nf data) (a b t f name) (pk skey))
  (defstrand bob 5 (Na Na) (Nb Nb) (a a) (b b) (pk pk))
  (defstrand third 5 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (precedes ((1 4) (0 0)))
  (leadsto ((1 4) (0 0)))
  (uniq-orig Nb)
  (operation state-passing-test (added-strand third 5) pk (0 0))
  (label 3)
  (parent 2)
  (unrealized)
  (shape)
  (maps ((0) ((a a) (b b) (Na Na) (Nb Nb) (pk pk))))
  (origs (Nb (0 2))))</pre>

<p id="t4">Tree <a href="#top">4</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 154.920' font-size='12.000'>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  </svg></div>

<pre>(defprotocol Pake basic
  (defrole fourth
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (send (enc Nf f (pubk t))) (recv (enc Nf Nt t (pubk f)))
      (send (enc Nt (pubk t)))
      (send (enc (enc pk (hash Nf Nt)) (pubk t))))
    (uniq-orig pk))
  (defrole third
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (recv (enc Nf f (pubk t))) (send (enc Nf Nt t (pubk f)))
      (recv (enc Nt (pubk t)))
      (recv (enc (enc pk (hash Nf Nt)) (pubk t))) (init pk)))
  (defrole alice
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (send Na) (recv Nb)
      (send (hash (hash pk a b Na Nb)))
      (recv (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb)))))
  (defrole bob
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (recv Na) (send Nb)
      (recv (hash (hash pk a b Na Nb)))
      (send (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))))))</pre>

<p id="k4">Item <a href="#t4">4</a>, Children: <a href="#k6">6</a> <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>third</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>Pake 4</text>
  </svg></div>

<pre>(defskeleton Pake
  (vars (Nt Nf data) (t f name) (pk skey))
  (defstrand third 5 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (non-orig (privk t) (privk f))
  (uniq-orig Nt)
  (label 4)
  (unrealized (0 2) (0 3))
  (origs (Nt (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t4">6</a>, Parent: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc Nt (pubk t))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>fourth</text>
   </g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>third</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>Pake 6 (realized)</text></svg></div>

<pre>(defskeleton Pake
  (vars (Nt Nf data) (t f name) (pk skey))
  (defstrand third 5 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (defstrand fourth 4 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (precedes ((0 1) (1 1)) ((1 2) (0 2)) ((1 3) (0 3)))
  (non-orig (privk t) (privk f))
  (uniq-orig Nt pk)
  (operation encryption-test (displaced 1 2 fourth 4)
    (enc pk (hash Nf Nt)) (0 3))
  (label 6)
  (parent 4)
  (unrealized)
  (shape)
  (maps ((0) ((t t) (f f) (Nt Nt) (Nf Nf) (pk pk))))
  (origs (pk (1 3)) (Nt (0 1))))</pre>

<p id="k9">Item <a href="#t4">9</a>, Parent: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc Nt (pubk t))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>pk</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>fourth</text>
   </g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>fourth</text>
   </g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>third</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>Pake 9 (realized)</text></svg></div>

<pre>(defskeleton Pake
  (vars (Nt Nf data) (t f name) (pk skey))
  (defstrand third 5 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (defstrand fourth 3 (Nt Nt) (Nf Nf) (t t) (f f))
  (defstrand fourth 4 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((1 2) (0 2)) ((2 3) (0 3)))
  (non-orig (privk t) (privk f))
  (uniq-orig Nt pk)
  (operation nonce-test (contracted (t-0 t) (f-0 f)) Nt (2 1)
    (enc Nf Nt t (pubk f)))
  (label 9)
  (parent 4)
  (unrealized)
  (shape)
  (maps ((0) ((t t) (f f) (Nt Nt) (Nf Nf) (pk pk))))
  (origs (pk (2 3)) (Nt (0 1))))</pre>

<p id="t18">Tree <a href="#top">18</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  </svg></div>

<pre>(defprotocol Pake basic
  (defrole fourth
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (send (enc Nf f (pubk t))) (recv (enc Nf Nt t (pubk f)))
      (send (enc Nt (pubk t)))
      (send (enc (enc pk (hash Nf Nt)) (pubk t))))
    (uniq-orig pk))
  (defrole third
    (vars (t f name) (pk skey) (Nt Nf data))
    (trace (recv (enc Nf f (pubk t))) (send (enc Nf Nt t (pubk f)))
      (recv (enc Nt (pubk t)))
      (recv (enc (enc pk (hash Nf Nt)) (pubk t))) (init pk)))
  (defrole alice
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (send Na) (recv Nb)
      (send (hash (hash pk a b Na Nb)))
      (recv (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb)))))
  (defrole bob
    (vars (a b name) (pk skey) (Na Nb data))
    (trace (obsv pk) (recv Na) (send Nb)
      (recv (hash (hash pk a b Na Nb)))
      (send (hash (hash (hash pk a b Na Nb)) (hash pk a b Na Nb))))))</pre>

<p id="k18">Item <a href="#t18">18</a>, Child: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>fourth</text></g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>Pake 18</text>
  </svg></div>

<pre>(defskeleton Pake
  (vars (Nt Nf data) (t f name) (pk skey))
  (defstrand fourth 4 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (non-orig (privk t) (privk f))
  (uniq-orig Nf pk)
  (label 18)
  (unrealized (0 1))
  (origs (pk (0 3)) (Nf (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t18">20</a>, Parent: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc Nf f (pubk t))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(enc (enc pk (hash Nf Nt)) (pubk t))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc Nt (pubk t))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc Nf Nt t (pubk f))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc Nf f (pubk t))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>third</text></g>
  <g><title>((Nt Nt) (Nf Nf) (t t) (f f) (pk pk))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>fourth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>Pake 20 (realized)</text></svg></div>

<pre>(defskeleton Pake
  (vars (Nf Nt data) (t f name) (pk skey))
  (defstrand fourth 4 (Nt Nt) (Nf Nf) (t t) (f f) (pk pk))
  (defstrand third 2 (Nt Nt) (Nf Nf) (t t) (f f))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (privk t) (privk f))
  (uniq-orig Nf pk)
  (operation nonce-test (contracted (Nt-0 Nt)) Nf (0 1)
    (enc Nf f (pubk t)) (enc Nf Nt t (pubk f)))
  (label 20)
  (parent 18)
  (unrealized)
  (shape)
  (maps ((0) ((t t) (f f) (Nt Nt) (Nf Nf) (pk pk))))
  (origs (pk (0 3)) (Nf (0 0))))</pre>

</body>
</html>
