<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Diffie Hellman Protocol</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;Diffie Hellman Protocol&quot; (algebra diffie-hellman))
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from dh.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t4">4</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='114.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol dh diffie-hellman
  (defrole alice
    (vars (a b name) (ra rndx) (bb base) (n text) (pw skey))
    (trace (send (exp (gen) ra)) (recv bb)
      (send (enc n (hash pw a b (exp (gen) ra) bb (exp bb ra))))
      (recv n))
    (uniq-gen ra))
  (defrole bob
    (vars (a b name) (rb rndx) (ba base) (n text) (pw skey))
    (trace (recv ba) (send (exp (gen) rb))
      (recv (enc n (hash pw a b ba (exp (gen) rb) (exp ba rb))))
      (send n))
    (uniq-gen rb)
    (absent (rb ba))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k1">1</a> <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>n</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n (hash pw a b (exp (gen) ra) bb (exp bb ra)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>bb</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(exp (gen) ra)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n n) (a a) (b b) (pw pw) (bb bb) (ra ra))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>alice</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>dh 0</text>
  </svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (bb base) (ra rndx))
  (defstrand alice 4 (n n) (a a) (b b) (pw pw) (bb bb) (ra ra))
  (pen-non-orig pw)
  (uniq-gen ra)
  (uniq-orig n)
  (label 0)
  (unrealized (0 3))
  (origs (n (0 2)))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>n</title><circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc n (hash pw a b (exp (gen) ra) (exp (gen) rb) (exp (gen) (mul ra rb))))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) rb)</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(exp (gen) ra)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>n</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc n (hash pw a b (exp (gen) ra) (exp (gen) rb) (exp (gen) (mul ra rb))))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(exp (gen) rb)</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) ra)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n n) (a a) (b b) (pw pw) (ba (exp (gen) ra)) (rb rb))</title>
   <text x='139.920' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <g>
   <title>((n n) (a a) (b b) (pw pw) (bb (exp (gen) rb)) (ra ra))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>alice</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>dh 1 (realized)</text></svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (ra rb rndx))
  (defstrand alice 4 (n n) (a a) (b b) (pw pw) (bb (exp (gen) rb))
    (ra ra))
  (defstrand bob 4 (n n) (a a) (b b) (pw pw) (ba (exp (gen) ra))
    (rb rb))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (rb (exp (gen) ra)))
  (pen-non-orig pw)
  (uniq-gen ra rb)
  (uniq-orig n)
  (operation nonce-test (added-strand bob 4) n (0 3)
    (enc n
      (hash pw a b (exp (gen) ra) (exp (gen) rb)
        (exp (gen) (mul ra rb)))))
  (label 1)
  (parent 0)
  (unrealized)
  (shape)
  (maps ((0) ((a a) (b b) (pw pw) (n n) (ra ra) (bb (exp (gen) rb)))))
  (origs (n (0 2))))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash pw a b (exp (gen) ra) bb (exp bb ra))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(hash pw a b (exp (gen) ra) bb (exp bb ra))</title>
   <circle style='fill: red;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>n</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n (hash pw a b (exp (gen) ra) bb (exp bb ra)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>bb</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) ra)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n n) (a a) (b b) (pw pw) (bb bb) (ra ra))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>alice</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>dh 2</text>
  </svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (bb base) (ra rndx))
  (defstrand alice 4 (n n) (a a) (b b) (pw pw) (bb bb) (ra ra))
  (deflistener (hash pw a b (exp (gen) ra) bb (exp bb ra)))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)))
  (pen-non-orig pw)
  (uniq-gen ra)
  (uniq-orig n)
  (operation nonce-test
    (added-listener (hash pw a b (exp (gen) ra) bb (exp bb ra))) n (0 3)
    (enc n (hash pw a b (exp (gen) ra) bb (exp bb ra))))
  (label 2)
  (parent 0)
  (unrealized (1 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pw a b (exp (gen) ra) bb (exp bb ra))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat pw a b (exp (gen) ra) bb (exp bb ra))</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.340 300.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash pw a b (exp (gen) ra) bb (exp bb ra))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(hash pw a b (exp (gen) ra) bb (exp bb ra))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>n</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n (hash pw a b (exp (gen) ra) bb (exp bb ra)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>bb</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) ra)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n n) (a a) (b b) (pw pw) (bb bb) (ra ra))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>alice</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>dh 3</text>
  </svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (bb base) (ra rndx))
  (defstrand alice 4 (n n) (a a) (b b) (pw pw) (bb bb) (ra ra))
  (deflistener (hash pw a b (exp (gen) ra) bb (exp bb ra)))
  (deflistener (cat pw a b (exp (gen) ra) bb (exp bb ra)))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (pen-non-orig pw)
  (uniq-gen ra)
  (uniq-orig n)
  (operation encryption-test
    (added-listener (cat pw a b (exp (gen) ra) bb (exp bb ra)))
    (hash pw a b (exp (gen) ra) bb (exp bb ra)) (1 0))
  (label 3)
  (parent 2)
  (unrealized (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t4">Tree <a href="#top">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='89.880' y1='114.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  </svg></div>

<pre>(defprotocol dh diffie-hellman
  (defrole alice
    (vars (a b name) (ra rndx) (bb base) (n text) (pw skey))
    (trace (send (exp (gen) ra)) (recv bb)
      (send (enc n (hash pw a b (exp (gen) ra) bb (exp bb ra))))
      (recv n))
    (uniq-gen ra))
  (defrole bob
    (vars (a b name) (rb rndx) (ba base) (n text) (pw skey))
    (trace (recv ba) (send (exp (gen) rb))
      (recv (enc n (hash pw a b ba (exp (gen) rb) (exp ba rb))))
      (send n))
    (uniq-gen rb)
    (absent (rb ba))))</pre>

<p id="k4">Item <a href="#t4">4</a>, Children: <a href="#k5">5</a> <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>n</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n (hash pw a b ba (exp (gen) rb) (exp ba rb)))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(exp (gen) rb)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>ba</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n n) (a a) (b b) (pw pw) (ba ba) (rb rb))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>dh 4</text>
  </svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (ba base) (rb rndx))
  (defstrand bob 4 (n n) (a a) (b b) (pw pw) (ba ba) (rb rb))
  (absent (rb ba))
  (pen-non-orig pw)
  (uniq-gen rb)
  (label 4)
  (unrealized (0 2))
  (origs)
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t4">5</a>, Parent: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc n (hash pw a b (exp (gen) ra) (exp (gen) rb) (exp (gen) (mul rb ra))))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(exp (gen) rb)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) ra)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>n</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc n (hash pw a b (exp (gen) ra) (exp (gen) rb) (exp (gen) (mul rb ra))))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) rb)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(exp (gen) ra)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((n n) (a a) (b b) (pw pw) (bb (exp (gen) rb)) (ra ra))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>alice</text></g>
  <g>
   <title>((n n) (a a) (b b) (pw pw) (ba (exp (gen) ra)) (rb rb))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>dh 5 (realized)</text></svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (rb ra rndx))
  (defstrand bob 4 (n n) (a a) (b b) (pw pw) (ba (exp (gen) ra))
    (rb rb))
  (defstrand alice 3 (n n) (a a) (b b) (pw pw) (bb (exp (gen) rb))
    (ra ra))
  (precedes ((0 1) (1 1)) ((1 0) (0 0)) ((1 2) (0 2)))
  (absent (rb (exp (gen) ra)))
  (pen-non-orig pw)
  (uniq-gen rb ra)
  (operation encryption-test (added-strand alice 3)
    (enc n
      (hash pw a b (exp (gen) ra) (exp (gen) rb)
        (exp (gen) (mul rb ra)))) (0 2))
  (label 5)
  (parent 4)
  (unrealized)
  (shape)
  (maps ((0) ((a a) (b b) (pw pw) (rb rb) (ba (exp (gen) ra)) (n n))))
  (origs))</pre>

<p id="k6">Item <a href="#t4">6</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash pw a b ba (exp (gen) rb) (exp ba rb))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(hash pw a b ba (exp (gen) rb) (exp ba rb))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>n</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc n (hash pw a b ba (exp (gen) rb) (exp ba rb)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) rb)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>ba</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n n) (a a) (b b) (pw pw) (ba ba) (rb rb))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>dh 6</text>
  </svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (ba base) (rb rndx))
  (defstrand bob 4 (n n) (a a) (b b) (pw pw) (ba ba) (rb rb))
  (deflistener (hash pw a b ba (exp (gen) rb) (exp ba rb)))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (absent (rb ba))
  (pen-non-orig pw)
  (uniq-gen rb)
  (operation encryption-test
    (added-listener (hash pw a b ba (exp (gen) rb) (exp ba rb)))
    (enc n (hash pw a b ba (exp (gen) rb) (exp ba rb))) (0 2))
  (label 6)
  (parent 4)
  (unrealized (1 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t4">7</a>, Parent: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pw a b ba (exp (gen) rb) (exp ba rb))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat pw a b ba (exp (gen) rb) (exp ba rb))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash pw a b ba (exp (gen) rb) (exp ba rb))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(hash pw a b ba (exp (gen) rb) (exp ba rb))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>n</title><circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc n (hash pw a b ba (exp (gen) rb) (exp ba rb)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(exp (gen) rb)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>ba</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((n n) (a a) (b b) (pw pw) (ba ba) (rb rb))</title>
   <text x='39.960' y='77.460' style='text-anchor: middle;'>bob</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>dh 7</text>
  </svg></div>

<pre>(defskeleton dh
  (vars (n text) (a b name) (pw skey) (ba base) (rb rndx))
  (defstrand bob 4 (n n) (a a) (b b) (pw pw) (ba ba) (rb rb))
  (deflistener (hash pw a b ba (exp (gen) rb) (exp ba rb)))
  (deflistener (cat pw a b ba (exp (gen) rb) (exp ba rb)))
  (precedes ((0 1) (2 0)) ((1 1) (0 2)) ((2 1) (1 0)))
  (absent (rb ba))
  (pen-non-orig pw)
  (uniq-gen rb)
  (operation encryption-test
    (added-listener (cat pw a b ba (exp (gen) rb) (exp ba rb)))
    (hash pw a b ba (exp (gen) rb) (exp ba rb)) (1 0))
  (label 7)
  (parent 6)
  (unrealized (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
